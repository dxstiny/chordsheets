import{d as M,u as q,r as w,o as k,i as T,g as e,t as y,m as I,n as b,f as l,p as A,h as j,_ as R,q as U,c as F,w as O,s as E,e as N,j as J,F as P,v as W}from"./main-01d35b45.js";import{I as u,D as Y}from"./Dropdown-d46ceb0a.js";import{d as z,E as G}from"./dom-to-image-4f79793a.js";import{T as H}from"./TextInput-d51d5163.js";import{E as B}from"./Editor-bb290192.js";import"./_commonjsHelpers-042e6b4d.js";const K=p=>(A("data-v-c192c0a9"),p=p(),j(),p),Q=K(()=>e("br",null,null,-1)),X={class:"actions"},Z=M({__name:"Import",setup(p,{expose:n}){const c=q(),d=w([]),a=w(),x=()=>{d.value=[];const r=document.createElement("input");r.type="file",r.accept=".json",r.onchange=_=>{var f;const m=(f=_.target.files)==null?void 0:f[0];if(!m)return;const i=new FileReader;i.onload=D=>{var t;const V=(t=D.target)==null?void 0:t.result,o=JSON.parse(V);if(!c.songs.length){c.songs=o;return}d.value=o,a.value.showModal()},i.readAsText(m)},r.click()},S=()=>{for(const r of d.value){const _=c.songs.find(m=>m.title===r.title&&m.artist===r.artist);_?Object.assign(_,r):c.songs.push(r)}d.value=[],a.value.close()},$=()=>{c.songs=d.value,d.value=[],a.value.close()};return n({show:x}),(r,_)=>(k(),T("dialog",{ref_key:"addOrOverwrite",ref:a},[e("h1",null,y(d.value.length)+" songs to import",1),e("p",null,[I(" You already have "+y(b(c).songs.length)+" songs in your library. ",1),Q,I(" Do you want to merge the libraries songs or overwrite the existing one? ")]),e("div",X,[l(u,{label:"Cancel",icon:"close",style:"red",onClick:_[0]||(_[0]=m=>a.value.close())}),l(u,{label:"Merge",icon:"merge",onClick:S}),l(u,{label:"Overwrite",icon:"sync_problem",style:"yellow",onClick:$})])],512))}});const ee=R(Z,[["__scopeId","data-v-c192c0a9"]]),g=p=>(A("data-v-beabaa75"),p=p(),j(),p),oe={class:"dashboard"},te={class:"wrap"},se=g(()=>e("h1",null,[I("Chord"),e("span",{class:"accent"},"Sheets")],-1)),ne={class:"flex"},le=g(()=>e("hr",null,null,-1)),ae={class:"filters"},re=g(()=>e("hr",null,null,-1)),ie={class:"song"},ce={class:"cover"},de=["src"],ue={class:"info"},pe={class:"bpm"},_e={class:"key"},ve=["onClick"],he={class:"card sticky learn"},ge={class:"content"},me=g(()=>e("h2",null,"Learn Music Theory",-1)),fe=g(()=>e("hr",null,null,-1)),we=g(()=>e("h2",null,"New editor coming soon!",-1)),ye=g(()=>e("p",null," The new editor will let you edit your songs directly in-place. No more switching between editor and preview. It also introduces new shortcuts to improve your workflow. ",-1)),be={class:"content"},ke={class:"preview-container"},xe={class:"preview scale-sm"},Ce=g(()=>e("h2",null,"Rendering...",-1)),Ie=g(()=>e("p",null," Please wait while we render your chord sheets. This may take a while. ",-1)),Se={class:"row"},$e=["value","max"],De={class:"void"},Ve={class:"parent"},Le=M({__name:"Dashboard",setup(p){const n=q(),c=w(),d=w(),a=w(-1),x=w(),S=async()=>{await n.prepareRender();const o=JSON.stringify(n.songs,null,4),t=document.createElement("a"),v=new Blob([o],{type:"text/plain"});t.href=URL.createObjectURL(v),t.download="chordsheets.json",t.click()},$=()=>{var o;(o=x.value)==null||o.show()},r=async()=>{var t,v;(t=d.value)==null||t.showModal();let o=new G({orientation:"portrait",unit:"px",format:"a4"});a.value=0;for(const h of c.value??[])console.log(h.name()),await h.renderTo(o),a.value++,h.song!==n.songs[n.songs.length-1]&&o.addPage();return(v=d.value)==null||v.close(),a.value=-1,o},_=async()=>{const o=await r();o.autoPrint(),o.output("dataurlnewwindow")},m=async()=>{(await r()).save("chordsheets.pdf")},i=w({artist:"",query:""}),f=w([]);U(()=>{f.value=n.songs.filter(o=>{if(i.value.artist&&i.value.artist!=="(any)"&&!o.artist.toLowerCase().includes(i.value.artist.toLowerCase()))return!1;const t=`${o.title} ${o.artist}`.toLowerCase();return!(i.value.query&&!t.includes(i.value.query.toLowerCase()))})});const D=({moved:o})=>{const t=n.songs.findIndex(s=>s.id===o.element.id),v=f.value[o.newIndex-1%f.value.length],h=v?n.songs.findIndex(s=>s.id===v.id):-1,C=o.newIndex>o.oldIndex?h:h+1;n.moveTo(t,C)},V=window.innerWidth<800;return(o,t)=>{var h,C;const v=F("router-link");return k(),T(P,null,[e("div",oe,[e("div",te,[e("main",null,[se,e("div",ne,[l(u,{icon:"add",label:"New Song",onClick:t[0]||(t[0]=s=>o.$router.push("/editor")),style:"green"}),l(u,{icon:"file_download",label:"Save Library",onClick:S,style:"yellow"}),l(u,{icon:"file_upload",label:"Import",onClick:$,style:"yellow"}),l(u,{label:"Export all as PDF",icon:"picture_as_pdf",onClick:m,style:"blue"}),l(u,{label:"Print All",icon:"print",onClick:_,style:"blue"})]),le,e("div",ae,[l(H,{label:"Search",modelValue:i.value.query,"onUpdate:modelValue":t[1]||(t[1]=s=>i.value.query=s),placeholder:"Search for a song"},null,8,["modelValue"]),l(Y,{label:"Artist",modelValue:i.value.artist,"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.artist=s),options:["(any)",...new Set(b(n).songs.map(s=>s.artist).sort())]},null,8,["modelValue","options"])]),re,l(b(z),{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=s=>f.value=s),class:"songs",onChange:D,"item-key":"id",onDragover:t[4]||(t[4]=E(()=>{},["stop"])),disabled:V},{item:O(({element:s})=>[l(v,{to:`/editor/${s.id}`},{default:O(()=>[e("div",ie,[e("div",ce,[e("img",{src:s.cover||"placeholders/song.svg"},null,8,de)]),e("div",ue,[e("h2",null,y(s.title),1),e("span",null,y(s.artist),1)]),e("span",pe,y(s.bpm)+" BPM ",1),e("span",_e,y(s.key),1),e("span",{class:"material-symbols-rounded delete",onClick:E(L=>b(n).removeSong(s),["prevent"])}," delete ",8,ve)])]),_:2},1032,["to"])]),_:1},8,["modelValue"])]),e("aside",he,[e("div",ge,[me,l(u,{label:"Try the Beta",icon:"arrow_forward",onClick:t[5]||(t[5]=s=>o.$router.push("/learn")),style:"blue"}),fe,we,ye,l(u,{label:"Try the preview",icon:"arrow_forward",onClick:t[6]||(t[6]=s=>{var L;return o.$router.push("/editor/v2/"+((L=b(n).songs[0])==null?void 0:L.id))}),style:"blue"})])])])]),e("dialog",{ref_key:"renderDialog",ref:d},[e("div",be,[e("div",ke,[e("div",xe,[a.value>=0?(k(),N(B,{key:0,printing:"",song:b(n).songs[a.value]},null,8,["song"])):J("",!0)])]),Ce,Ie,e("div",Se,[e("progress",{value:a.value,max:(h=c.value)==null?void 0:h.length},null,8,$e),e("p",null,[e("span",null,y(a.value),1),I(" / "+y((C=c.value)==null?void 0:C.length),1)])])])],512),l(ee,{ref_key:"importDialog",ref:x},null,512),e("div",De,[e("div",Ve,[(k(!0),T(P,null,W(b(n).songs,s=>(k(),N(B,{ref_for:!0,ref_key:"allPages",ref:c,printing:"",song:s},null,8,["song"]))),256))])])],64)}}});const Me=R(Le,[["__scopeId","data-v-beabaa75"]]);export{Me as default};
