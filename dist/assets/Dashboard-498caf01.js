import{d as T,u as q,r as f,o as k,c as $,a as e,t as m,i as I,j as b,k as n,p as B,f as E,_ as j,w as R,l as U,m as P,q as O,b as A,e as F,F as M,h as J}from"./main-cbfee9d6.js";import{I as w,D as W}from"./Dropdown-cbd847b4.js";import{T as Y,A as N,d as z,E as G}from"./vuedraggable.umd-3c63e8fe.js";import"./_commonjsHelpers-19599571.js";const H=_=>(B("data-v-c192c0a9"),_=_(),E(),_),K=H(()=>e("br",null,null,-1)),Q={class:"actions"},X=T({__name:"Import",setup(_,{expose:l}){const i=q(),d=f([]),a=f(),x=()=>{d.value=[];const r=document.createElement("input");r.type="file",r.accept=".json",r.onchange=p=>{var h;const v=(h=p.target.files)==null?void 0:h[0];if(!v)return;const c=new FileReader;c.onload=V=>{var s;const L=(s=V.target)==null?void 0:s.result,t=JSON.parse(L);if(!i.songs.length){i.songs=t;return}d.value=t,a.value.showModal()},c.readAsText(v)},r.click()},S=()=>{for(const r of d.value){const p=i.songs.find(v=>v.title===r.title&&v.artist===r.artist);p?Object.assign(p,r):i.songs.push(r)}d.value=[],a.value.close()},D=()=>{i.songs=d.value,d.value=[],a.value.close()};return l({show:x}),(r,p)=>(k(),$("dialog",{ref_key:"addOrOverwrite",ref:a},[e("h1",null,m(d.value.length)+" songs to import",1),e("p",null,[I(" You already have "+m(b(i).songs.length)+" songs in your library. ",1),K,I(" Do you want to merge the libraries songs or overwrite the existing one? ")]),e("div",Q,[n(w,{label:"Cancel",icon:"close",style:"red",onClick:p[0]||(p[0]=v=>a.value.close())}),n(w,{label:"Merge",icon:"merge",onClick:S}),n(w,{label:"Overwrite",icon:"sync_problem",style:"yellow",onClick:D})])],512))}});const Z=j(X,[["__scopeId","data-v-c192c0a9"]]),y=_=>(B("data-v-9b5d0e28"),_=_(),E(),_),ee={class:"dashboard"},te={class:"wrap"},se=y(()=>e("h1",null,[I("Chord"),e("span",{class:"accent"},"Sheets")],-1)),oe={class:"flex"},le=y(()=>e("hr",null,null,-1)),ne={class:"filters"},ae=y(()=>e("hr",null,null,-1)),re={class:"song"},ie={class:"cover"},ce=["src"],de={class:"info"},ue={class:"bpm"},_e={class:"key"},pe=["onClick"],ve={class:"card sticky learn"},he={class:"content"},ge=y(()=>e("h2",null,"Learn Music Theory",-1)),fe=y(()=>e("p",null,"Now in beta!",-1)),me={class:"content"},we={class:"preview-container"},ye={class:"preview scale-sm"},be=y(()=>e("h2",null,"Rendering...",-1)),ke=y(()=>e("p",null," Please wait while we render your chord sheets. This may take a while. ",-1)),xe={class:"row"},Ce=["value","max"],Ie={class:"void"},Se={class:"parent"},De=T({__name:"Dashboard",setup(_){const l=q(),i=f(),d=f(),a=f(-1),x=f(),S=async()=>{await l.prepareRender();const t=JSON.stringify(l.songs,null,4),s=document.createElement("a"),u=new Blob([t],{type:"text/plain"});s.href=URL.createObjectURL(u),s.download="chordsheets.json",s.click()},D=()=>{var t;(t=x.value)==null||t.show()},r=async()=>{var s,u;(s=d.value)==null||s.showModal();let t=new G({orientation:"portrait",unit:"px",format:"a4"});a.value=0;for(const g of i.value??[])await g.renderTo(t),a.value++,g.song!==l.songs[l.songs.length-1]&&t.addPage();return(u=d.value)==null||u.close(),a.value=-1,t},p=async()=>{const t=await r();t.autoPrint(),t.output("dataurlnewwindow")},v=async()=>{(await r()).save("chordsheets.pdf")},c=f({artist:"",query:""}),h=f([]);R(()=>{h.value=l.songs.filter(t=>{if(c.value.artist&&c.value.artist!=="(any)"&&!t.artist.toLowerCase().includes(c.value.artist.toLowerCase()))return!1;const s=`${t.title} ${t.artist}`.toLowerCase();return!(c.value.query&&!s.includes(c.value.query.toLowerCase()))})});const V=({moved:t})=>{const s=l.songs.findIndex(o=>o.id===t.element.id),u=h.value[t.newIndex-1%h.value.length],g=u?l.songs.findIndex(o=>o.id===u.id):-1,C=t.newIndex>t.oldIndex?g:g+1;l.moveTo(s,C)},L=window.innerWidth<800;return(t,s)=>{var g,C;const u=U("router-link");return k(),$(M,null,[e("div",ee,[e("div",te,[e("main",null,[se,e("div",oe,[n(w,{icon:"add",label:"New Song",onClick:s[0]||(s[0]=o=>t.$router.push("/editor")),style:"green"}),n(w,{icon:"file_download",label:"Save Library",onClick:S,style:"yellow"}),n(w,{icon:"file_upload",label:"Import",onClick:D,style:"yellow"}),n(w,{label:"Export all as PDF",icon:"picture_as_pdf",onClick:v,style:"blue"}),n(w,{label:"Print All",icon:"print",onClick:p,style:"blue"})]),le,e("div",ne,[n(Y,{label:"Search",modelValue:c.value.query,"onUpdate:modelValue":s[1]||(s[1]=o=>c.value.query=o),placeholder:"Search for a song"},null,8,["modelValue"]),n(W,{label:"Artist",modelValue:c.value.artist,"onUpdate:modelValue":s[2]||(s[2]=o=>c.value.artist=o),options:["(any)",...new Set(b(l).songs.map(o=>o.artist))]},null,8,["modelValue","options"])]),ae,n(b(z),{modelValue:h.value,"onUpdate:modelValue":s[3]||(s[3]=o=>h.value=o),class:"songs",onChange:V,"item-key":"id",onDragover:s[4]||(s[4]=O(()=>{},["stop"])),disabled:L},{item:P(({element:o})=>[n(u,{to:`/editor/${o.id}`},{default:P(()=>[e("div",re,[e("div",ie,[e("img",{src:o.cover||"placeholders/song.svg"},null,8,ce)]),e("div",de,[e("h2",null,m(o.title),1),e("span",null,m(o.artist),1)]),e("span",ue,m(o.bpm)+" BPM ",1),e("span",_e,m(o.key),1),e("span",{class:"material-symbols-rounded delete",onClick:O(Ve=>b(l).removeSong(o),["prevent"])}," delete ",8,pe)])]),_:2},1032,["to"])]),_:1},8,["modelValue"])]),e("aside",ve,[e("div",he,[n(u,{to:"/learn"},{default:P(()=>[ge]),_:1}),fe])])])]),e("dialog",{ref_key:"renderDialog",ref:d},[e("div",me,[e("div",we,[e("div",ye,[a.value>=0?(k(),A(N,{key:0,ref_key:"allPages",ref:i,song:b(l).songs[a.value]},null,8,["song"])):F("",!0)])]),be,ke,e("div",xe,[e("progress",{value:a.value,max:(g=i.value)==null?void 0:g.length},null,8,Ce),e("p",null,[e("span",null,m(a.value),1),I(" / "+m((C=i.value)==null?void 0:C.length),1)])])])],512),n(Z,{ref_key:"importDialog",ref:x},null,512),e("div",Ie,[e("div",Se,[(k(!0),$(M,null,J(b(l).songs,o=>(k(),A(N,{ref_for:!0,ref_key:"allPages",ref:i,song:o},null,8,["song"]))),256))])])],64)}}});const Ae=j(De,[["__scopeId","data-v-9b5d0e28"]]);export{Ae as default};
