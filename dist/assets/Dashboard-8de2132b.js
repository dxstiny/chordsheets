import{d as $,u as R,r as v,w as U,a as j,c as S,b as e,e as r,f,g as b,h as I,i as V,j as F,t as p,k as D,F as L,l as O,o as w,p as J,m as W,_ as z}from"./main-15d5d88a.js";import{I as m,D as G}from"./Dropdown-4371a4d9.js";import{T as H,A as P,d as K,E as Q}from"./vuedraggable.umd-ddad08de.js";import"./_commonjsHelpers-c635f644.js";const u=g=>(J("data-v-d1fae45a"),g=g(),W(),g),X={class:"dashboard"},Y={class:"wrap"},Z=u(()=>e("h1",null,[D("Chord"),e("span",{class:"accent"},"Sheets")],-1)),ee={class:"flex"},se=u(()=>e("hr",null,null,-1)),te={class:"filters"},oe=u(()=>e("hr",null,null,-1)),ne={class:"song"},ae={class:"cover"},le=["src"],re={class:"info"},ie={class:"bpm"},de={class:"key"},ce=["onClick"],ue={class:"card min-h-screen sticky learn"},pe={class:"content"},_e=u(()=>e("h2",null,"Learn Music Theory",-1)),he=u(()=>e("p",null,"Coming soon...",-1)),ve={class:"content"},fe={class:"preview-container"},me={class:"preview scale-sm"},ge=u(()=>e("h2",null,"Rendering...",-1)),we=u(()=>e("p",null," Please wait while we render your chord sheets. This may take a while. ",-1)),ye={class:"row"},be=["value","max"],ke={class:"void"},xe={class:"parent"},Ce=$({__name:"Dashboard",setup(g){const n=R(),_=v(),y=v(),d=v(-1),A=async()=>{await n.prepareRender();const s=JSON.stringify(n.songs,null,4),o=document.createElement("a"),a=new Blob([s],{type:"text/plain"});o.href=URL.createObjectURL(a),o.download="chordsheets.json",o.click()},T=()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=o=>{var c;const a=(c=o.target.files)==null?void 0:c[0];if(!a)return;const l=new FileReader;l.onload=t=>{var C;const x=(C=t.target)==null?void 0:C.result,M=JSON.parse(x);n.songs=M},l.readAsText(a)},s.click()},k=async()=>{var o,a;(o=y.value)==null||o.showModal();let s=new Q({orientation:"portrait",unit:"px",format:"a4"});d.value=0;for(const l of _.value??[])await l.renderTo(s),d.value++,l.song!==n.songs[n.songs.length-1]&&s.addPage();return(a=y.value)==null||a.close(),d.value=-1,s},B=async()=>{const s=await k();s.autoPrint(),s.output("dataurlnewwindow")},E=async()=>{(await k()).save("chordsheets.pdf")},i=v({artist:"",query:""}),h=v([]);U(()=>{h.value=n.songs.filter(s=>{if(i.value.artist&&i.value.artist!=="(any)"&&!s.artist.toLowerCase().includes(i.value.artist.toLowerCase()))return!1;const o=`${s.title} ${s.artist}`.toLowerCase();return!(i.value.query&&!o.includes(i.value.query.toLowerCase()))})});const N=({moved:s})=>{const o=n.songs.findIndex(t=>t.id===s.element.id),a=h.value[s.newIndex-1%h.value.length],l=a?n.songs.findIndex(t=>t.id===a.id):-1,c=s.newIndex>s.oldIndex?l:l+1;n.moveTo(o,c)},q=window.innerWidth<800;return(s,o)=>{var l,c;const a=j("router-link");return w(),S(L,null,[e("div",X,[e("div",Y,[e("main",null,[Z,e("div",ee,[r(m,{icon:"add",label:"New Song",onClick:o[0]||(o[0]=t=>s.$router.push("/editor")),style:"green"}),r(m,{icon:"file_download",label:"Save Library",onClick:A,style:"yellow"}),r(m,{icon:"file_upload",label:"Import Library",onClick:T,style:"yellow"}),r(m,{label:"Export all as PDF",icon:"picture_as_pdf",onClick:E,style:"blue"}),r(m,{label:"Print All",icon:"print",onClick:B,style:"blue"})]),se,e("div",te,[r(H,{label:"Search",modelValue:i.value.query,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value.query=t),placeholder:"Search for a song"},null,8,["modelValue"]),r(G,{label:"Artist",modelValue:i.value.artist,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value.artist=t),options:["(any)",...new Set(f(n).songs.map(t=>t.artist))]},null,8,["modelValue","options"])]),oe,r(f(K),{modelValue:h.value,"onUpdate:modelValue":o[3]||(o[3]=t=>h.value=t),class:"songs",onChange:N,"item-key":"id",onDragover:o[4]||(o[4]=I(()=>{},["stop"])),disabled:q},{item:b(({element:t})=>[r(a,{to:`/editor/${t.id}`},{default:b(()=>[e("div",ne,[e("div",ae,[e("img",{src:t.cover||"placeholders/song.svg"},null,8,le)]),e("div",re,[e("h2",null,p(t.title),1),e("span",null,p(t.artist),1)]),e("span",ie,p(t.bpm)+" BPM ",1),e("span",de,p(t.key),1),e("span",{class:"material-symbols-rounded delete",onClick:I(x=>f(n).removeSong(t),["prevent"])}," delete ",8,ce)])]),_:2},1032,["to"])]),_:1},8,["modelValue"])]),e("aside",ue,[e("div",pe,[r(a,{to:"/learn"},{default:b(()=>[_e]),_:1}),he])])])]),e("dialog",{ref_key:"renderDialog",ref:y,class:"card"},[e("div",ve,[e("div",fe,[e("div",me,[d.value>=0?(w(),V(P,{key:0,ref_key:"allPages",ref:_,song:f(n).songs[d.value]},null,8,["song"])):F("",!0)])]),ge,we,e("div",ye,[e("progress",{value:d.value,max:(l=_.value)==null?void 0:l.length},null,8,be),e("p",null,[e("span",null,p(d.value),1),D(" / "+p((c=_.value)==null?void 0:c.length),1)])])])],512),e("div",ke,[e("div",xe,[(w(!0),S(L,null,O(f(n).songs,t=>(w(),V(P,{ref_for:!0,ref_key:"allPages",ref:_,song:t},null,8,["song"]))),256))])])],64)}}});const Pe=z(Ce,[["__scopeId","data-v-d1fae45a"]]);export{Pe as default};
