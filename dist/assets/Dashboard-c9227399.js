import{d as $,u as R,r as f,w as U,a as j,c as I,b as e,e as r,f as v,g as k,h as V,i as L,j as F,t as p,k as D,F as P,l as O,o as y,p as J,m as W,_ as z}from"./main-46eef390.js";import{I as m,D as G}from"./Dropdown-795c702d.js";import{T as H,A,d as K,E as Q}from"./vuedraggable.umd-8215ac2c.js";import"./_commonjsHelpers-dbf1be81.js";const u=g=>(J("data-v-df65c134"),g=g(),W(),g),X={class:"dashboard"},Y={class:"wrap"},Z=u(()=>e("h1",null,[D("Chord"),e("span",{class:"accent"},"Sheets")],-1)),ee={class:"flex"},se=u(()=>e("hr",null,null,-1)),te={class:"filters"},oe=u(()=>e("hr",null,null,-1)),ne={class:"song"},le={class:"cover"},ae=["src"],re={class:"info"},ie={class:"bpm"},de={class:"key"},ce=["onClick"],ue={class:"card min-h-screen sticky learn"},pe={class:"content"},_e=u(()=>e("h2",null,"Learn Music Theory",-1)),he=u(()=>e("p",null,"Coming soon...",-1)),fe={class:"content"},ve={class:"preview-container"},me={class:"preview scale-sm"},ge=u(()=>e("h2",null,"Rendering...",-1)),ye=u(()=>e("p",null," Please wait while we render your chord sheets. This may take a while. ",-1)),we={class:"row"},be=["value","max"],ke={class:"void"},xe={class:"parent"},Ce=$({__name:"Dashboard",setup(g){const n=R(),_=f(),w=f(),d=f(-1),T=async()=>{await n.prepareRender();const s=JSON.stringify(n.songs,null,4),o=document.createElement("a"),l=new Blob([s],{type:"text/plain"});o.href=URL.createObjectURL(l),o.download="chordsheets.json",o.click()},B=()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=o=>{var c;const l=(c=o.target.files)==null?void 0:c[0];if(!l)return;const a=new FileReader;a.onload=t=>{var S;const C=(S=t.target)==null?void 0:S.result,b=JSON.parse(C);if(!Array.isArray(b)){n.songs.push(b);return}n.songs=b},a.readAsText(l)},s.click()},x=async()=>{var o,l;(o=w.value)==null||o.showModal();let s=new Q({orientation:"portrait",unit:"px",format:"a4"});d.value=0;for(const a of _.value??[])await a.renderTo(s),d.value++,a.song!==n.songs[n.songs.length-1]&&s.addPage();return(l=w.value)==null||l.close(),d.value=-1,s},E=async()=>{const s=await x();s.autoPrint(),s.output("dataurlnewwindow")},N=async()=>{(await x()).save("chordsheets.pdf")},i=f({artist:"",query:""}),h=f([]);U(()=>{h.value=n.songs.filter(s=>{if(i.value.artist&&i.value.artist!=="(any)"&&!s.artist.toLowerCase().includes(i.value.artist.toLowerCase()))return!1;const o=`${s.title} ${s.artist}`.toLowerCase();return!(i.value.query&&!o.includes(i.value.query.toLowerCase()))})});const q=({moved:s})=>{const o=n.songs.findIndex(t=>t.id===s.element.id),l=h.value[s.newIndex-1%h.value.length],a=l?n.songs.findIndex(t=>t.id===l.id):-1,c=s.newIndex>s.oldIndex?a:a+1;n.moveTo(o,c)},M=window.innerWidth<800;return(s,o)=>{var a,c;const l=j("router-link");return y(),I(P,null,[e("div",X,[e("div",Y,[e("main",null,[Z,e("div",ee,[r(m,{icon:"add",label:"New Song",onClick:o[0]||(o[0]=t=>s.$router.push("/editor")),style:"green"}),r(m,{icon:"file_download",label:"Save Library",onClick:T,style:"yellow"}),r(m,{icon:"file_upload",label:"Import Library",onClick:B,style:"yellow"}),r(m,{label:"Export all as PDF",icon:"picture_as_pdf",onClick:N,style:"blue"}),r(m,{label:"Print All",icon:"print",onClick:E,style:"blue"})]),se,e("div",te,[r(H,{label:"Search",modelValue:i.value.query,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value.query=t),placeholder:"Search for a song"},null,8,["modelValue"]),r(G,{label:"Artist",modelValue:i.value.artist,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value.artist=t),options:["(any)",...new Set(v(n).songs.map(t=>t.artist))]},null,8,["modelValue","options"])]),oe,r(v(K),{modelValue:h.value,"onUpdate:modelValue":o[3]||(o[3]=t=>h.value=t),class:"songs",onChange:q,"item-key":"id",onDragover:o[4]||(o[4]=V(()=>{},["stop"])),disabled:M},{item:k(({element:t})=>[r(l,{to:`/editor/${t.id}`},{default:k(()=>[e("div",ne,[e("div",le,[e("img",{src:t.cover||"placeholders/song.svg"},null,8,ae)]),e("div",re,[e("h2",null,p(t.title),1),e("span",null,p(t.artist),1)]),e("span",ie,p(t.bpm)+" BPM ",1),e("span",de,p(t.key),1),e("span",{class:"material-symbols-rounded delete",onClick:V(C=>v(n).removeSong(t),["prevent"])}," delete ",8,ce)])]),_:2},1032,["to"])]),_:1},8,["modelValue"])]),e("aside",ue,[e("div",pe,[r(l,{to:"/learn"},{default:k(()=>[_e]),_:1}),he])])])]),e("dialog",{ref_key:"renderDialog",ref:w,class:"card"},[e("div",fe,[e("div",ve,[e("div",me,[d.value>=0?(y(),L(A,{key:0,ref_key:"allPages",ref:_,song:v(n).songs[d.value]},null,8,["song"])):F("",!0)])]),ge,ye,e("div",we,[e("progress",{value:d.value,max:(a=_.value)==null?void 0:a.length},null,8,be),e("p",null,[e("span",null,p(d.value),1),D(" / "+p((c=_.value)==null?void 0:c.length),1)])])])],512),e("div",ke,[e("div",xe,[(y(!0),I(P,null,O(v(n).songs,t=>(y(),L(A,{ref_for:!0,ref_key:"allPages",ref:_,song:t},null,8,["song"]))),256))])])],64)}}});const Pe=z(Ce,[["__scopeId","data-v-df65c134"]]);export{Pe as default};
