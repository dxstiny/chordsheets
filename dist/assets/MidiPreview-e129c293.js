import{d as j,m as y,j as i,g as M,F as k,n as b,q as p,l as E,o as s,_ as T}from"./main-f436b829.js";const q={key:0,class:"keyboard"},F=j({__name:"MidiPreview",props:{track:{type:Object,required:!0},width:{type:Number,default:1e3},height:{type:Number,default:300}},setup($){const c=$,h=y(()=>({width:c.width-20,height:c.height})),v=y(()=>c.track.notes),o=y(()=>{if(!v.value)return null;let n=Math.min(...v.value.map(r=>r.note)),e=Math.max(...v.value.map(r=>r.note));const l=Math.min(...v.value.map(r=>r.start)),a=Math.max(...v.value.map(r=>r.start+r.duration));return n=Math.floor(n/12)*12,e=Math.ceil(e/12)*12,{y:{min:n,max:e},x:{min:l,max:a}}}),t=y(()=>{if(!o.value)return null;const{x:n,y:e}=o.value,l=h.value.width/n.max,a=h.value.height/(e.max-e.min+1);return{x:l,y:a}}),B=()=>{if(!t.value||!o.value)return null;const{x:n,y:e}=o.value;return!n||!e?null:{height:`${t.value.y*(1+e.max-e.min)}px`,width:`${t.value.x*n.max}px`}},C=n=>{if(!t.value||!o.value)return null;const{x:e,y:l}=o.value;if(!e||!l)return null;const a=n.note-l.min,r=n.start;return{backgroundColor:"var(--accent)",position:"absolute",height:`${t.value.y}px`,width:`${n.duration*t.value.x}px`,bottom:`${a*t.value.y}px`,left:`${r*t.value.x}px`}},S=()=>{if(!t.value||!o.value)return null;const{x:n,y:e}=o.value;if(!n||!e)return null;const l=[];for(let a=e.min;a<=e.max;a++){const m=[1,3,6,8,10].includes(a%12)?"var(--color-background-soft)":"var(--color-background)",x=c.track.signature.clocksPerTick*c.track.signature.numerator,f=2**c.track.signature.denominator;let u="repeating-linear-gradient(to right,";for(let d=0;d<f;d++){const w=d%f===f-1?"black":"var(--color-background-soft)",N=d*x*t.value.x,g=(d+1)*x*t.value.x;u+=`${m} ${N+1}px,`,u+=`${m} ${g}px,`,u+=`${w} ${g}px,`,u+=`${w} ${g+1}px,`}u=u.slice(0,-1)+")",l.push({background:u,position:"absolute",height:`${t.value.y}px`,width:h.value.width+"px",bottom:`${(a-e.min)*t.value.y}px`,left:"0px"})}return l},P=()=>{if(!t.value||!o.value)return null;const{x:n,y:e}=o.value;if(!n||!e)return null;const l=[];for(let a=e.min;a<=e.max;a++){const r=[1,3,6,8,10].includes(a%12),m=a%12===0,_=r?"black":m?"lightgrey":"white",x=r?.7:1;l.push({backgroundColor:_,position:"absolute",height:`${t.value.y}px`,width:`${20*x}px`,bottom:`${(a-e.min)*t.value.y}px`,left:"0px"}),r&&l.push({backgroundColor:"white",position:"absolute",height:`${t.value.y}px`,width:`${20*(1-x)}px`,bottom:`${(a-e.min)*t.value.y}px`,left:`${x*100*t.value.x}px`})}return l},K=()=>{if(!t.value||!o.value)return null;const{x:n,y:e}=o.value;return!n||!e?null:{height:`${(1+e.max-e.min)*t.value.y}px`,width:"20px"}};return(n,e)=>$.track?(s(),i("div",q,[M("div",{class:"keys",style:p(K())},[(s(!0),i(k,null,b(P(),l=>(s(),i("div",{style:p(l)},null,4))),256))],4),M("div",{class:"notes",style:p(B())},[(s(!0),i(k,null,b(S(),l=>(s(),i("div",{style:p(l)},null,4))),256)),(s(!0),i(k,null,b(v.value,l=>(s(),i("div",{class:"note",style:p(C(l))},null,4))),256))],4)])):E("",!0)}});const V=T(F,[["__scopeId","data-v-c2612ebf"]]);export{V as M};
