import{d as E,c as g,b as c,e as M,F as b,g as $,n as y,k as T,o as v}from"./main-8fa8462d.js";const j=(p,u)=>{const x=p.__vccOpts||p;for(const[s,o]of u)x[s]=o;return x},F={key:0,class:"keyboard"},I=E({__name:"MidiPreview",props:{track:{type:Object,required:!0},width:{type:Number,default:1e3},height:{type:Number,default:300}},setup(p){const u=p,x=g(()=>({width:u.width,height:u.height})),s=g(()=>u.track.notes),o=g(()=>{if(!s.value)return null;let n=Math.min(...s.value.map(r=>r.note)),e=Math.max(...s.value.map(r=>r.note));const a=Math.min(...s.value.map(r=>r.start)),l=Math.max(...s.value.map(r=>r.start+r.duration));return n=Math.floor(n/12)*12,e=Math.ceil(e/12)*12,{y:{min:n,max:e},x:{min:a,max:l}}}),t=g(()=>{if(!o.value)return null;const{x:n,y:e}=o.value,a=x.value.width/n.max,l=x.value.height/(e.max-e.min+1);return{x:a,y:l}}),B=()=>{if(!t.value||!o.value)return null;const{x:n,y:e}=o.value;return!n||!e?null:{height:`${t.value.y*(1+e.max-e.min)}px`,width:`${t.value.x*n.max}px`}},C=n=>{if(!t.value||!o.value)return null;const{x:e,y:a}=o.value;if(!e||!a)return null;const l=n.note-a.min,r=n.start;return{backgroundColor:"var(--accent)",position:"absolute",height:`${t.value.y}px`,width:`${n.duration*t.value.x}px`,bottom:`${l*t.value.y}px`,left:`${r*t.value.x}px`}},S=()=>{if(!t.value||!o.value)return null;const{x:n,y:e}=o.value;if(!n||!e)return null;const a=[];for(let l=e.min;l<=e.max;l++){const h=[1,3,6,8,10].includes(l%12)?"var(--color-background)":"var(--color-background-soft)",d=u.track.signature.clocksPerTick*u.track.signature.numerator,f=2**u.track.signature.denominator;let i="repeating-linear-gradient(to right,";for(let m=0;m<f;m++){const w=m%f===f-1?"black":"var(--color-background-soft)",N=m*d*t.value.x,k=(m+1)*d*t.value.x;i+=`${h} ${N+1}px,`,i+=`${h} ${k}px,`,i+=`${w} ${k}px,`,i+=`${w} ${k+1}px,`}i=i.slice(0,-1)+")",a.push({background:i,position:"absolute",height:`${t.value.y}px`,width:x.value.width+"px",bottom:`${(l-e.min)*t.value.y}px`,left:"0px"})}return a},P=()=>{if(!t.value||!o.value)return null;const{x:n,y:e}=o.value;if(!n||!e)return null;const a=[];for(let l=e.min;l<=e.max;l++){const r=[1,3,6,8,10].includes(l%12),h=l%12===0,_=r?"black":h?"lightgrey":"white",d=r?.7:1;a.push({backgroundColor:_,position:"absolute",height:`${t.value.y}px`,width:`${100*d*t.value.x}px`,bottom:`${(l-e.min)*t.value.y}px`,left:"0px"}),r&&a.push({backgroundColor:"white",position:"absolute",height:`${t.value.y}px`,width:`${(100-100*d)*t.value.x}px`,bottom:`${(l-e.min)*t.value.y}px`,left:`${d*100*t.value.x}px`})}return a},K=()=>{if(!t.value||!o.value)return null;const{x:n,y:e}=o.value;return!n||!e?null:{height:`${(1+e.max-e.min)*t.value.y}px`,width:`${100*t.value.x}px`}};return(n,e)=>p.track?(v(),c("div",F,[M("div",{class:"keys",style:y(K())},[(v(!0),c(b,null,$(P(),a=>(v(),c("div",{style:y(a)},null,4))),256))],4),M("div",{class:"notes",style:y(B())},[(v(!0),c(b,null,$(S(),a=>(v(),c("div",{style:y(a)},null,4))),256)),(v(!0),c(b,null,$(s.value,a=>(v(),c("div",{class:"note",style:y(C(a))},null,4))),256))],4)])):T("",!0)}});const V=j(I,[["__scopeId","data-v-ea63dac3"]]);export{V as M,j as _};
