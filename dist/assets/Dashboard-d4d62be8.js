import{d as A,u as B,r as w,o as k,j as P,g as e,t as y,s as I,v as b,f as n,p as M,h as q,_ as j,x as R,c as U,w as T,y as O,e as E,l as F,F as N,n as J}from"./main-e2895b3d.js";import{I as u,D as W}from"./Dropdown-c85d14a6.js";import{T as Y,A as z}from"./TextInput-4c5bfc6e.js";import{d as G,E as H}from"./vuedraggable.umd-c5cff502.js";import{E as K}from"./Editor-73221622.js";import"./MidiPreview-6bec033b.js";import"./_commonjsHelpers-042e6b4d.js";const Q=p=>(M("data-v-c192c0a9"),p=p(),q(),p),X=Q(()=>e("br",null,null,-1)),Z={class:"actions"},ee=A({__name:"Import",setup(p,{expose:l}){const i=B(),c=w([]),a=w(),x=()=>{c.value=[];const r=document.createElement("input");r.type="file",r.accept=".json",r.onchange=_=>{var f;const g=(f=_.target.files)==null?void 0:f[0];if(!g)return;const d=new FileReader;d.onload=D=>{var o;const V=(o=D.target)==null?void 0:o.result,t=JSON.parse(V);if(!i.songs.length){i.songs=t;return}c.value=t,a.value.showModal()},d.readAsText(g)},r.click()},S=()=>{for(const r of c.value){const _=i.songs.find(g=>g.title===r.title&&g.artist===r.artist);_?Object.assign(_,r):i.songs.push(r)}c.value=[],a.value.close()},$=()=>{i.songs=c.value,c.value=[],a.value.close()};return l({show:x}),(r,_)=>(k(),P("dialog",{ref_key:"addOrOverwrite",ref:a},[e("h1",null,y(c.value.length)+" songs to import",1),e("p",null,[I(" You already have "+y(b(i).songs.length)+" songs in your library. ",1),X,I(" Do you want to merge the libraries songs or overwrite the existing one? ")]),e("div",Z,[n(u,{label:"Cancel",icon:"close",style:"red",onClick:_[0]||(_[0]=g=>a.value.close())}),n(u,{label:"Merge",icon:"merge",onClick:S}),n(u,{label:"Overwrite",icon:"sync_problem",style:"yellow",onClick:$})])],512))}});const te=j(ee,[["__scopeId","data-v-c192c0a9"]]),h=p=>(M("data-v-6baf365e"),p=p(),q(),p),oe={class:"dashboard"},se={class:"wrap"},le=h(()=>e("h1",null,[I("Chord"),e("span",{class:"accent"},"Sheets")],-1)),ne={class:"flex"},ae=h(()=>e("hr",null,null,-1)),re={class:"filters"},ie=h(()=>e("hr",null,null,-1)),de={class:"song"},ce={class:"cover"},ue=["src"],pe={class:"info"},_e={class:"bpm"},ve={class:"key"},he=["onClick"],ge={class:"card sticky learn"},fe={class:"content"},me=h(()=>e("h2",null,"Learn Music Theory",-1)),we=h(()=>e("hr",null,null,-1)),ye=h(()=>e("h2",null,"New editor coming soon!",-1)),be=h(()=>e("p",null," The new editor will let you edit your songs directly in-place. No more switching between editor and preview. It also introduces new shortcuts to improve your workflow. ",-1)),ke={class:"content"},xe={class:"preview-container"},Ce={class:"preview scale-sm"},Ie=h(()=>e("h2",null,"Rendering...",-1)),Se=h(()=>e("p",null," Please wait while we render your chord sheets. This may take a while. ",-1)),$e={class:"row"},De=["value","max"],Ve={class:"void"},Le={class:"parent"},Pe=A({__name:"Dashboard",setup(p){const l=B(),i=w(),c=w(),a=w(-1),x=w(),S=async()=>{await l.prepareRender();const t=JSON.stringify(l.songs,null,4),o=document.createElement("a"),v=new Blob([t],{type:"text/plain"});o.href=URL.createObjectURL(v),o.download="chordsheets.json",o.click()},$=()=>{var t;(t=x.value)==null||t.show()},r=async()=>{var o,v;(o=c.value)==null||o.showModal();let t=new H({orientation:"portrait",unit:"px",format:"a4"});a.value=0;for(const m of i.value??[])await m.renderTo(t),a.value++,m.song!==l.songs[l.songs.length-1]&&t.addPage();return(v=c.value)==null||v.close(),a.value=-1,t},_=async()=>{const t=await r();t.autoPrint(),t.output("dataurlnewwindow")},g=async()=>{(await r()).save("chordsheets.pdf")},d=w({artist:"",query:""}),f=w([]);R(()=>{f.value=l.songs.filter(t=>{if(d.value.artist&&d.value.artist!=="(any)"&&!t.artist.toLowerCase().includes(d.value.artist.toLowerCase()))return!1;const o=`${t.title} ${t.artist}`.toLowerCase();return!(d.value.query&&!o.includes(d.value.query.toLowerCase()))})});const D=({moved:t})=>{const o=l.songs.findIndex(s=>s.id===t.element.id),v=f.value[t.newIndex-1%f.value.length],m=v?l.songs.findIndex(s=>s.id===v.id):-1,C=t.newIndex>t.oldIndex?m:m+1;l.moveTo(o,C)},V=window.innerWidth<800;return(t,o)=>{var m,C;const v=U("router-link");return k(),P(N,null,[e("div",oe,[e("div",se,[e("main",null,[le,e("div",ne,[n(u,{icon:"add",label:"New Song",onClick:o[0]||(o[0]=s=>t.$router.push("/editor")),style:"green"}),n(u,{icon:"file_download",label:"Save Library",onClick:S,style:"yellow"}),n(u,{icon:"file_upload",label:"Import",onClick:$,style:"yellow"}),n(u,{label:"Export all as PDF",icon:"picture_as_pdf",onClick:g,style:"blue"}),n(u,{label:"Print All",icon:"print",onClick:_,style:"blue"})]),ae,e("div",re,[n(Y,{label:"Search",modelValue:d.value.query,"onUpdate:modelValue":o[1]||(o[1]=s=>d.value.query=s),placeholder:"Search for a song"},null,8,["modelValue"]),n(W,{label:"Artist",modelValue:d.value.artist,"onUpdate:modelValue":o[2]||(o[2]=s=>d.value.artist=s),options:["(any)",...new Set(b(l).songs.map(s=>s.artist).sort())]},null,8,["modelValue","options"])]),ie,n(b(G),{modelValue:f.value,"onUpdate:modelValue":o[3]||(o[3]=s=>f.value=s),class:"songs",onChange:D,"item-key":"id",onDragover:o[4]||(o[4]=O(()=>{},["stop"])),disabled:V},{item:T(({element:s})=>[n(v,{to:`/editor/${s.id}`},{default:T(()=>[e("div",de,[e("div",ce,[e("img",{src:s.cover||"placeholders/song.svg"},null,8,ue)]),e("div",pe,[e("h2",null,y(s.title),1),e("span",null,y(s.artist),1)]),e("span",_e,y(s.bpm)+" BPM ",1),e("span",ve,y(s.key),1),e("span",{class:"material-symbols-rounded delete",onClick:O(L=>b(l).removeSong(s),["prevent"])}," delete ",8,he)])]),_:2},1032,["to"])]),_:1},8,["modelValue"])]),e("aside",ge,[e("div",fe,[me,n(u,{label:"Try the Beta",icon:"arrow_forward",onClick:o[5]||(o[5]=s=>t.$router.push("/learn")),style:"blue"}),we,ye,be,n(u,{label:"Try the preview",icon:"arrow_forward",onClick:o[6]||(o[6]=s=>{var L;return t.$router.push("/editor/v2/"+((L=b(l).songs[0])==null?void 0:L.id))}),style:"blue"})])])])]),e("dialog",{ref_key:"renderDialog",ref:c},[e("div",ke,[e("div",xe,[e("div",Ce,[a.value>=0?(k(),E(K,{key:0,printing:"",ref_key:"allPages",ref:i,song:b(l).songs[a.value]},null,8,["song"])):F("",!0)])]),Ie,Se,e("div",$e,[e("progress",{value:a.value,max:(m=i.value)==null?void 0:m.length},null,8,De),e("p",null,[e("span",null,y(a.value),1),I(" / "+y((C=i.value)==null?void 0:C.length),1)])])])],512),n(te,{ref_key:"importDialog",ref:x},null,512),e("div",Ve,[e("div",Le,[(k(!0),P(N,null,J(b(l).songs,s=>(k(),E(z,{ref_for:!0,ref_key:"allPages",ref:i,song:s},null,8,["song"]))),256))])])],64)}}});const qe=j(Pe,[["__scopeId","data-v-6baf365e"]]);export{qe as default};
