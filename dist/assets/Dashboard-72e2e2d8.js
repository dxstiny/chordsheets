import{d as $,u as M,r as v,w as R,a as U,c as S,b as e,e as r,f,g as b,h as I,i as V,j,t as p,k as D,F as L,l as F,o as y,p as O,m as J,_ as z}from"./main-f8fa1c53.js";import{I as m,D as G}from"./Dropdown-13470a0a.js";import{T as H,A as P,d as K,E as Q}from"./vuedraggable.umd-bbe8c4f7.js";import"./_commonjsHelpers-678b9a21.js";const u=g=>(O("data-v-5ca130cc"),g=g(),J(),g),W={class:"dashboard"},X={class:"wrap"},Y=u(()=>e("h1",null,[D("Chord"),e("span",{class:"accent"},"Sheets")],-1)),Z={class:"flex"},ee=u(()=>e("hr",null,null,-1)),se={class:"filters"},te=u(()=>e("hr",null,null,-1)),oe={class:"song"},le={class:"cover"},ne=["src"],ae={class:"info"},re={class:"bpm"},ie={class:"key"},ce=["onClick"],de={class:"card min-h-screen sticky learn"},ue={class:"content"},pe=u(()=>e("h2",null,"Learn Music Theory",-1)),_e=u(()=>e("p",null,"Coming soon...",-1)),he={class:"content"},ve={class:"preview-container"},fe={class:"preview scale-sm"},me=u(()=>e("h2",null,"Rendering...",-1)),ge=u(()=>e("p",null," Please wait while we render your chord sheets. This may take a while. ",-1)),ye={class:"row"},we=["value","max"],be={class:"void"},ke={class:"parent"},xe=$({__name:"Dashboard",setup(g){const l=M(),_=v(),w=v(),c=v(-1),A=async()=>{await l.prepareRender();const s=JSON.stringify(l.songs,null,4),o=document.createElement("a"),n=new Blob([s],{type:"text/plain"});o.href=URL.createObjectURL(n),o.download="chordsheets.json",o.click()},T=()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=o=>{var d;const n=(d=o.target.files)==null?void 0:d[0];if(!n)return;const a=new FileReader;a.onload=t=>{var C;const x=(C=t.target)==null?void 0:C.result,q=JSON.parse(x);l.songs=q},a.readAsText(n)},s.click()},k=async()=>{var o,n;(o=w.value)==null||o.showModal();let s=new Q({orientation:"portrait",unit:"px",format:"a4"});c.value=0;for(const a of _.value??[])await a.renderTo(s),c.value++,a.song!==l.songs[l.songs.length-1]&&s.addPage();return(n=w.value)==null||n.close(),c.value=-1,s},B=async()=>{const s=await k();s.autoPrint(),s.output("dataurlnewwindow")},E=async()=>{(await k()).save("chordsheets.pdf")},i=v({artist:"",query:""}),h=v([]);R(()=>{h.value=l.songs.filter(s=>{if(i.value.artist&&i.value.artist!=="(any)"&&!s.artist.toLowerCase().includes(i.value.artist.toLowerCase()))return!1;const o=`${s.title} ${s.artist}`.toLowerCase();return!(i.value.query&&!o.includes(i.value.query.toLowerCase()))})});const N=({moved:s})=>{const o=l.songs.findIndex(t=>t.id===s.element.id),n=h.value[s.newIndex-1%h.value.length],a=n?l.songs.findIndex(t=>t.id===n.id):-1,d=s.newIndex>s.oldIndex?a:a+1;l.moveTo(o,d)};return(s,o)=>{var a,d;const n=U("router-link");return y(),S(L,null,[e("div",W,[e("div",X,[e("main",null,[Y,e("div",Z,[r(m,{icon:"add",label:"New Song",onClick:o[0]||(o[0]=t=>s.$router.push("/editor")),style:"green"}),r(m,{icon:"file_download",label:"Save Library",onClick:A,style:"yellow"}),r(m,{icon:"file_upload",label:"Import Library",onClick:T,style:"yellow"}),r(m,{label:"Export all as PDF",icon:"picture_as_pdf",onClick:E,style:"blue"}),r(m,{label:"Print All",icon:"print",onClick:B,style:"blue"})]),ee,e("div",se,[r(H,{label:"Search",modelValue:i.value.query,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value.query=t),placeholder:"Search for a song"},null,8,["modelValue"]),r(G,{label:"Artist",modelValue:i.value.artist,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value.artist=t),options:["(any)",...new Set(f(l).songs.map(t=>t.artist))]},null,8,["modelValue","options"])]),te,r(f(K),{modelValue:h.value,"onUpdate:modelValue":o[3]||(o[3]=t=>h.value=t),class:"songs",onChange:N,"item-key":"id",onDragover:o[4]||(o[4]=I(()=>{},["stop"]))},{item:b(({element:t})=>[r(n,{to:`/editor/${t.id}`},{default:b(()=>[e("div",oe,[e("div",le,[e("img",{src:t.cover||"placeholders/song.svg"},null,8,ne)]),e("div",ae,[e("h2",null,p(t.title),1),e("span",null,p(t.artist),1)]),e("span",re,p(t.bpm)+" BPM ",1),e("span",ie,p(t.key),1),e("span",{class:"material-symbols-rounded delete",onClick:I(x=>f(l).removeSong(t),["prevent"])}," delete ",8,ce)])]),_:2},1032,["to"])]),_:1},8,["modelValue"])]),e("aside",de,[e("div",ue,[r(n,{to:"/learn"},{default:b(()=>[pe]),_:1}),_e])])])]),e("dialog",{ref_key:"renderDialog",ref:w,class:"card"},[e("div",he,[e("div",ve,[e("div",fe,[c.value>=0?(y(),V(P,{key:0,ref_key:"allPages",ref:_,song:f(l).songs[c.value]},null,8,["song"])):j("",!0)])]),me,ge,e("div",ye,[e("progress",{value:c.value,max:(a=_.value)==null?void 0:a.length},null,8,we),e("p",null,[e("span",null,p(c.value),1),D(" / "+p((d=_.value)==null?void 0:d.length),1)])])])],512),e("div",be,[e("div",ke,[(y(!0),S(L,null,F(f(l).songs,t=>(y(),V(P,{ref_for:!0,ref_key:"allPages",ref:_,song:t},null,8,["song"]))),256))])])],64)}}});const Le=z(xe,[["__scopeId","data-v-5ca130cc"]]);export{Le as default};
