import{d as L,u as N,r as m,g as x,k as C,i as e,t as g,D,E as h,h as r,p as A,j,_ as O,l as R,A as F,H as J,s as z,e as H,w as B,y as P,f as U,F as q,C as W}from"./main-e2930811.js";import{I as f,D as Y}from"./Dropdown-86e6fb07.js";import{a as G,E as K}from"./dom-to-image-be0e4674.js";import{T as Q}from"./TextInput-f01e9071.js";import{E as M}from"./Editor-98e16fb0.js";import"./_commonjsHelpers-042e6b4d.js";const X=a=>(A("data-v-c192c0a9"),a=a(),j(),a),Z=X(()=>e("br",null,null,-1)),ee={class:"actions"},te=L({__name:"Import",setup(a,{expose:y}){const l=N(),n=m([]),i=m(),u=()=>{n.value=[];const d=document.createElement("input");d.type="file",d.accept=".json",d.onchange=p=>{var c;const b=(c=p.target.files)==null?void 0:c[0];if(!b)return;const I=new FileReader;I.onload=k=>{var t;const T=(t=k.target)==null?void 0:t.result,V=JSON.parse(T);if(!l.songs.length){l.songs=V;return}n.value=V,i.value.showModal()},I.readAsText(b)},d.click()},S=()=>{for(const d of n.value){const p=l.songs.find(b=>b.title===d.title&&b.artist===d.artist);p?Object.assign(p,d):l.songs.push(d)}n.value=[],i.value.close()},E=()=>{l.songs=n.value,n.value=[],i.value.close()};return y({show:u}),(d,p)=>(x(),C("dialog",{ref_key:"addOrOverwrite",ref:i},[e("h1",null,g(n.value.length)+" songs to import",1),e("p",null,[D(" You already have "+g(h(l).songs.length)+" songs in your library. ",1),Z,D(" Do you want to merge the libraries songs or overwrite the existing one? ")]),e("div",ee,[r(f,{label:"Cancel",icon:"close",style:"red",onClick:p[0]||(p[0]=b=>i.value.close())}),r(f,{label:"Merge",icon:"merge",onClick:S}),r(f,{label:"Overwrite",icon:"sync_problem",style:"yellow",onClick:E})])],512))}});const oe=O(te,[["__scopeId","data-v-c192c0a9"]]),se={key:0},le=L({__name:"Switch",props:{modelValue:{required:!0,type:Boolean},label:{required:!1,type:String}},emits:["update:modelValue"],setup(a,{emit:y}){const l=n=>{y("update:modelValue",n)};return(n,i)=>(x(),C("div",{class:"switch",onClick:i[0]||(i[0]=u=>l(!a.modelValue))},[a.label?(x(),C("h2",se,g(a.label),1)):R("",!0),e("span",{class:F(["slider",{checked:a.modelValue}])},null,2)]))}});const ne=O(le,[["__scopeId","data-v-40e1aca5"]]),ae=J("settings",()=>{const a=m(!0);return{newEditor:a,editorUrl:l=>{let n="/editor/";return a.value&&(n+="v2/"),n+l}}}),w=a=>(A("data-v-616bf890"),a=a(),j(),a),re={class:"dashboard"},ie={class:"wrap"},de=w(()=>e("h1",null,[D("Chord"),e("span",{class:"accent"},"Sheets")],-1)),ce={class:"flex"},ue=w(()=>e("hr",null,null,-1)),pe={class:"filters"},_e=w(()=>e("hr",null,null,-1)),ve={class:"song"},he={class:"cover"},me=["src"],ge={class:"info"},fe={class:"bpm"},we={class:"key"},ye=["onClick"],be={class:"card sticky learn"},ke={class:"content"},xe=w(()=>e("h2",null,"Learn Music Theory",-1)),Ce=w(()=>e("hr",null,null,-1)),Se=w(()=>e("h2",null,"Try the new editor!",-1)),Ie=w(()=>e("p",null," The new editor will let you edit your songs directly in-place. No more switching between editor and preview. It also introduces new shortcuts to improve your workflow. ",-1)),Ve={class:"content"},$e={class:"preview-container"},De={class:"preview scale-sm"},Ee=w(()=>e("h2",null,"Rendering...",-1)),Te=w(()=>e("p",null," Please wait while we render your chord sheets. This may take a while. ",-1)),Le={class:"row"},Oe=["value","max"],Be={class:"void"},Pe={class:"parent"},Ue=L({__name:"Dashboard",setup(a){const y=ae(),l=N(),n=m(),i=m(),u=m(-1),S=m(),E=async()=>{await l.prepareRender();const t=JSON.stringify(l.songs,null,4),o=document.createElement("a"),_=new Blob([t],{type:"text/plain"});o.href=URL.createObjectURL(_),o.download="chordsheets.json",o.click()},d=()=>{var t;(t=S.value)==null||t.show()},p=async()=>{var o,_;(o=i.value)==null||o.showModal();let t=new K({orientation:"portrait",unit:"px",format:"a4"});u.value=0;for(const v of n.value??[])console.log(v.name()),await v.renderTo(t),u.value++,v.song!==l.songs[l.songs.length-1]&&t.addPage();return(_=i.value)==null||_.close(),u.value=-1,t},b=async()=>{const t=await p();t.autoPrint(),t.output("dataurlnewwindow")},I=async()=>{(await p()).save("chordsheets.pdf")},c=m({artist:"",query:""}),k=m([]);z(()=>{k.value=l.songs.filter(t=>{if(c.value.artist&&c.value.artist!=="(any)"&&!t.artist.toLowerCase().includes(c.value.artist.toLowerCase()))return!1;const o=`${t.title} ${t.artist}`.toLowerCase();return!(c.value.query&&!o.includes(c.value.query.toLowerCase()))})});const T=({moved:t})=>{const o=l.songs.findIndex(s=>s.id===t.element.id),_=k.value[t.newIndex-1%k.value.length],v=_?l.songs.findIndex(s=>s.id===_.id):-1,$=t.newIndex>t.oldIndex?v:v+1;l.moveTo(o,$)},V=window.innerWidth<800;return(t,o)=>{var v,$;const _=H("router-link");return x(),C(q,null,[e("div",re,[e("div",ie,[e("main",null,[de,e("div",ce,[r(f,{icon:"add",label:"New Song",onClick:o[0]||(o[0]=s=>t.$router.push("/editor")),style:"green"}),r(f,{icon:"file_download",label:"Save Library",onClick:E,style:"yellow"}),r(f,{icon:"file_upload",label:"Import",onClick:d,style:"yellow"}),r(f,{label:"Export all as PDF",icon:"picture_as_pdf",onClick:I,style:"blue"}),r(f,{label:"Print All",icon:"print",onClick:b,style:"blue"})]),ue,e("div",pe,[r(Q,{label:"Search",modelValue:c.value.query,"onUpdate:modelValue":o[1]||(o[1]=s=>c.value.query=s),placeholder:"Search for a song"},null,8,["modelValue"]),r(Y,{label:"Artist",modelValue:c.value.artist,"onUpdate:modelValue":o[2]||(o[2]=s=>c.value.artist=s),options:["(any)",...new Set(h(l).songs.map(s=>s.artist).sort())]},null,8,["modelValue","options"])]),_e,r(h(G),{modelValue:k.value,"onUpdate:modelValue":o[3]||(o[3]=s=>k.value=s),class:"songs",onChange:T,"item-key":"id",onDragover:o[4]||(o[4]=P(()=>{},["stop"])),disabled:V},{item:B(({element:s})=>[r(_,{to:h(y).editorUrl(s.id)},{default:B(()=>[e("div",ve,[e("div",he,[e("img",{src:s.cover||"placeholders/song.svg"},null,8,me)]),e("div",ge,[e("h2",null,g(s.title),1),e("span",null,g(s.artist),1)]),e("span",fe,g(s.bpm)+" BPM ",1),e("span",we,g(s.key),1),e("span",{class:"material-symbols-rounded delete",onClick:P(qe=>h(l).removeSong(s),["prevent"])}," delete ",8,ye)])]),_:2},1032,["to"])]),_:1},8,["modelValue"])]),e("aside",be,[e("div",ke,[xe,r(f,{label:"Try the Beta",icon:"arrow_forward",onClick:o[5]||(o[5]=s=>t.$router.push("/learn")),style:"blue"}),Ce,Se,Ie,r(ne,{class:"try-new-editor",modelValue:h(y).newEditor,"onUpdate:modelValue":o[6]||(o[6]=s=>h(y).newEditor=s),label:"Try the new editor"},null,8,["modelValue"])])])])]),e("dialog",{ref_key:"renderDialog",ref:i},[e("div",Ve,[e("div",$e,[e("div",De,[u.value>=0?(x(),U(M,{key:0,printing:"",song:h(l).songs[u.value]},null,8,["song"])):R("",!0)])]),Ee,Te,e("div",Le,[e("progress",{value:u.value,max:(v=n.value)==null?void 0:v.length},null,8,Oe),e("p",null,[e("span",null,g(u.value),1),D(" / "+g(($=n.value)==null?void 0:$.length),1)])])])],512),r(oe,{ref_key:"importDialog",ref:S},null,512),e("div",Be,[e("div",Pe,[(x(!0),C(q,null,W(h(l).songs,s=>(x(),U(M,{ref_for:!0,ref_key:"allPages",ref:n,printing:"",song:s},null,8,["song"]))),256))])])],64)}}});const Je=O(Ue,[["__scopeId","data-v-616bf890"]]);export{Je as default};
