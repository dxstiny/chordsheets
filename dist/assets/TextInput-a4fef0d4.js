import{M as W}from"./MidiPreview-e129c293.js";import{d as T,r as P,m as E,o as s,j as o,g as n,t as r,s as k,l as p,F as v,n as w,D as j,f as N,p as z,h as H,_ as V,i as L,z as O,E as D,e as F}from"./main-f436b829.js";import{a as J,E as R}from"./vuedraggable.umd-5d20f546.js";import{I as G}from"./Dropdown-24d00590.js";const S=e=>(z("data-v-42d65bab"),e=e(),H(),e),U={key:0,class:"meta"},K={class:"wrap-to-line"},Q={class:"info"},X=S(()=>n("span",{class:"material-symbols-rounded"},"music_note",-1)),Y={class:"info"},Z=S(()=>n("span",{class:"material-symbols-rounded"},"piano",-1)),ee={key:0,class:"info"},te={class:"material-symbols-rounded"},se={key:1,class:"info"},ne={class:"material-symbols-rounded"},oe={key:0,class:"info"},ae=S(()=>n("span",{class:"material-symbols-rounded"}," check ",-1)),le={class:"capitalise"},ce={key:0},re={class:"instruments"},ie={class:"instrument"},ue={class:"flex space-between"},de={class:"flex gap-2"},ge=S(()=>n("span",{class:"material-symbols-rounded"},"volume_up",-1)),_e={class:"settings"},he={class:"muted"},pe={key:0},ve={class:"structure"},fe=S(()=>n("hr",null,null,-1)),me=["id"],ye={class:"progression"},be=["onClick"],ke=T({__name:"Page",props:{currentPage:{required:!0,type:Number},pages:{required:!0,type:Array},song:{required:!0,type:Object}},setup(e,{expose:I}){const u=e,h=P([]),g=P([]),y=P(),$=()=>[...h.value,...g.value],C=(l,a)=>{const d=new CustomEvent("chord-click",{detail:{sectionIndex:l,chordIndex:a}});window.dispatchEvent(d)};I({getSections:$});const q=l=>{let{type:a,name:d}=l;return a==="(other)"?d:a+(d?`: ${d}`:"")},_=E(()=>{var l;return(l=u.pages[u.currentPage])==null?void 0:l.filter(a=>a==null?void 0:a.type)}),i=E(()=>u.pages[u.currentPage].filter(l=>l==null?void 0:l.signature));return(l,a)=>{var d,f,m;return s(),o("div",{class:"page",ref_key:"page",ref:y},[e.currentPage==0?(s(),o("div",U,[n("h2",null,r(e.song.artist),1),n("h1",null,r(e.song.title),1),n("div",K,[n("div",Q,[X,k(" "+r(e.song.bpm)+" BPM ",1)]),n("div",Y,[Z,k(" "+r(e.song.key),1)]),e.song.transpose?(s(),o("div",ee,[n("span",te,r(e.song.transpose>0?"arrow_upward":"arrow_downward"),1),k(" "+r(e.song.transpose),1)])):p("",!0),e.song.octave?(s(),o("div",se,[n("span",ne,r(e.song.octave>0?"arrow_upward":"arrow_downward"),1),k(" "+r(e.song.octave)+" octave ",1)])):p("",!0),(s(!0),o(v,null,w((d=e.song.legacy)==null?void 0:d.options,(t,c)=>(s(),o(v,null,[t?(s(),o("div",oe,[ae,n("span",le,r(c),1)])):p("",!0)],64))),256))]),Object.keys(((f=e.song.legacy)==null?void 0:f.instruments)??{}).length?(s(),o("hr",ce)):p("",!0),n("div",re,[(s(!0),o(v,null,w((m=e.song.legacy)==null?void 0:m.instruments,(t,c)=>(s(),o("div",ie,[n("div",ue,[n("span",null,r(c),1),n("span",de,[ge,k(" "+r(t==null?void 0:t.volume),1)])]),n("div",_e,[n("h3",null,r(t==null?void 0:t.name),1),n("span",he,[k(r(t==null?void 0:t.type)+" ",1),t!=null&&t.page?(s(),o(v,{key:0},[k(" | P"+r(t==null?void 0:t.page),1)],64)):p("",!0)])])]))),256))]),e.song.structure?(s(),o(v,{key:1},[e.song.structure.length?(s(),o("hr",pe)):p("",!0),n("div",ve,[(s(!0),o(v,null,w(e.song.structure,t=>(s(),o("span",null,r(t),1))),256))])],64)):p("",!0),fe])):p("",!0),(s(!0),o(v,null,w(_.value,(t,c)=>(s(),o("div",{class:"section",ref_for:!0,ref_key:"sections",ref:h,id:String(c)},[n("span",null,r(q(t)),1),n("div",ye,[(s(!0),o(v,null,w(t.progression,(b,x)=>(s(),o("div",{class:j(["chord",`w-${b.duration}`+(b.selected?" selected":"")]),onClick:A=>C(c,x)},r(b.chord),11,be))),256))])],8,me))),256)),e.song.midi?(s(!0),o(v,{key:1},w(i.value,t=>{var c;return s(),o("div",{class:"section",ref_for:!0,ref_key:"midiSections",ref:g},[n("span",null,r(t==null?void 0:t.name),1),N(W,{track:t,width:((c=y.value)==null?void 0:c.clientWidth)??400},null,8,["track","width"])],512)}),256)):p("",!0)],512)}}});const we=V(ke,[["__scopeId","data-v-42d65bab"]]),Pe={class:"wrap"},Ie=T({__name:"AllPages",props:{song:{required:!0,type:Object}},setup(e,{expose:I}){const u=e,h=P(),g=P(),y=P(),$=()=>{var f,m,t;const i=(f=g.value)==null?void 0:f[0];if(!i)return;const l=[],a=(t=(m=y.value)==null?void 0:m[0])==null?void 0:t.getSections();if(!a)return;const d=[...u.song.sections,...u.song.midi??[]];for(let c=0;c<a.length;c++){const b=a[c],x=d[c],A=b.getBoundingClientRect().bottom,M=(i==null?void 0:i.getBoundingClientRect().height)??0,B=Math.ceil(A/M)-1;if(!l[B]){l[B]=[x];continue}l[B].push(x)}_.value=l,_.value.length||_.value.push([null])};L($),O(()=>u.song.sections.length,()=>{_.value=[[...u.song.sections,...u.song.midi??[]]],D($)});const C=async i=>{if(!h.value)return i;const l=h.value.querySelectorAll(".parent__element");let a=l[0];const d=a.clientHeight/a.clientWidth;for(let t=0;t<_.value.length;t++){if(a=l[t],!a)continue;var f=i.internal.pageSize.getWidth(),m=i.internal.pageSize.getHeight();const c=2,b=await J.toJpeg(a,{height:a.offsetHeight*c,width:a.offsetWidth*c,style:{transform:`scale(${c}) translate(${a.offsetWidth/2/c}px, ${a.offsetHeight/2/c}px)`}});m=d*f,i.addImage(b,"JPG",0,0,f,m),t+1<_.value.length&&i.addPage()}return i},q=async()=>{const i=new R({orientation:"portrait",unit:"px",format:"a4"});return await C(i),i},_=P([[...u.song.sections,...u.song.midi??[]]]);return _.value[0].length===0&&(_.value=[[null]]),I({render:q,renderTo:C,song:u.song}),(i,l)=>(s(),o("div",{ref_key:"allpageselement",ref:h,id:"allPages"},[(s(!0),o(v,null,w(_.value,(a,d)=>(s(),o("div",{class:"print a4 parent__element",ref_for:!0,ref_key:"parent",ref:g},[n("div",Pe,[N(we,{class:"page__element",ref_for:!0,ref_key:"element",ref:y,song:e.song,pages:_.value,currentPage:d},null,8,["song","pages","currentPage"])])],512))),256))],512))}});const Ee=V(Ie,[["__scopeId","data-v-b8c86e17"]]),Se={class:"input"},$e={key:0},Ce={class:"items"},xe=["value","placeholder"],qe=T({__name:"TextInput",props:{modelValue:{required:!0,type:String},label:{required:!1,type:String},placeholder:{required:!1,type:String},buttonLabel:{required:!1,type:String},buttonIcon:{required:!1,type:String}},emits:["update:modelValue","change","buttonClick"],setup(e,{emit:I}){const u=h=>{const g=h.target.value;I("update:modelValue",g)};return(h,g)=>(s(),o("div",Se,[e.label?(s(),o("h2",$e,r(e.label),1)):p("",!0),n("div",Ce,[n("input",{value:e.modelValue,onInput:u,class:"textinput",type:"text",placeholder:e.placeholder,onChange:g[0]||(g[0]=y=>h.$emit("change"))},null,40,xe),e.buttonLabel||e.buttonIcon?(s(),F(G,{key:0,label:e.buttonLabel,icon:e.buttonIcon,onClick:g[1]||(g[1]=y=>h.$emit("buttonClick"))},null,8,["label","icon"])):p("",!0)])]))}});const Ne=V(qe,[["__scopeId","data-v-818508fa"]]);export{Ee as A,we as P,Ne as T};
